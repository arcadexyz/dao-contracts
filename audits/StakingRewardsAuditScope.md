# Target Repository
- **Repository:** https://github.com/arcadexyz/dao-contracts
- **Commit hash:** 42dc6bb513d8d8ee977ef3be9d37dbdb55f237a1
- **Language:** Solidity
- **Platform:** Ethereum Mainnet

## Vulnerability Level Details
Vulnerability threat level is determined on a 5-level scale:

| Level    | Impact                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Critical | - Direct theft of any user funds, whether at-rest or in-motion, other than unclaimed yield<br>- Permanent freezing of funds<br>- Ability for an attacker to cause the entire staking pool to freeze, including stakes in which they are not a participant<br>- Ability for an attacker to steal any token held by the staking pool, without limitation, including stakes in which they are not a participant<br>- The alteration of a user's voting power<br>- Ability for an attacker to gain governance voting power for stakes in which they are not a participant<br>- Ability for an attacker to claim rewards for stakes in which they are not a participant<br>- Ability for an attacker to withdraw staking tokens for stakes in which they are not a participant                                                                                                                  |
| High     | - Theft of unclaimed yield<br>- Permanent freezing of unclaimed yield<br>- Temporary freezing of funds<br>- The ability of the user to withdraw their staked tokens before the end of the lock period<br>- The ability to force the contract to issue rewards without a user having deposited staking tokens<br>- The ability to force the issuance of a bonus multiplier incompatible with the chosen lock period<br>- The ability to force the issuance of voting power incompatible with the properties of a user’s stake<br>- The ability to prevent another staker from claiming their rewards<br>- The ability to prevent another staker from withdrawing their staking tokens<br>- The ability to overdraw rewards<br>- The ability to overdraw staking tokens<br>- The unauthorized funding of the contract with rewards tokens<br>- The unauthorized setting of a rewards duration |
| Medium   | - Smart contract unable to operate due to lack of token funds<br>- Ability to freeze the staking pool, without affecting currently staked assets<br>- Griefing (e.g. no profit motive for an attacker, but damage to the users or the protocol)<br>- Theft of gas<br>- Unbounded gas consumption<br>- Ability to drain or block rewards<br>- Ability to block the recovery of ERC20 tokens by contract owners                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Low      | - Contract fails to deliver promised rewards, but doesn't lose value<br>- Any finding which impacts contract logic without circumventing staking rules or stealing/freezing user funds                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| None     | - Gas optimizations<br>- Code style and formatting                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

## Scope
| Contract Name            | SLOC | Purpose/ Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | External Dependencies                                            |
| ------------------------ | ---- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- |
| ArcadeStakingRewards.sol | 466  | The ArcadeStakingRewards contract manages a staking system allowing users to lock ERC20 tokens to accrue rewards over time, based on the staked amount and duration. It supports multiple independent staking deposits for the same user, each earning rewards until the end of the staking term. <br><br>Upon staking, users commit to a lock period, preventing fund movement until its conclusion. Funds not withdrawn after this period automatically enter a new staking cycle without a lock-in, allowing free withdrawal. The contract incentivizes longer lock periods with a bonus multiplier for rewards.<br><br>Additionally, this contract integrates governance features, enabling staking to grant voting power for ArcadeDAO governance. | - @openzeppelin/*<br>- council governance<br>- arcade-governance |


## Out of Scope Details & Rules
Within the defined scope above, the general rules are that:
- The staking contract is based on the following assumptions about token behavior:
    - External token contracts (for staking and reward tokens) are assumed to follow relevant ERC20 token standards.
    - Any attack related to token upgradeability is out of scope. Lost balances related to fee-on-transfer tokens are out of scope.
    - Attacks related to special admin permission of tokens (e.g. an ERC20 where admins can transfer any user’s tokens) are out of scope.
    - Attacks related to explicitly malicious implementations of standard token functions (e.g. ERC20 tokens that consume the block gas limit on transfer) are out of scope.



- The staking contract assumes the following operational and trust models:
    - For any contract which is Ownable or contains privileged operations for certain addresses, the owner addresses are assumed to behave rationally and honestly.
    - All contracts should be assumed to be deployed and configured correctly.
    - Users in the staking process are assumed to act in their own financial self-interest.
    - Any finding or impact which is derived from one of the above assumptions being broken (e.g., an upgradeable ERC20 that can be made to fail on transfer via upgrade) is out of scope for this program.

